{% extends "template.html" %}
{% load static %}

{% block title %}
    <title>login</title>
{% endblock %}
{% block css_js %}
    <style>
        #my_panel_heading {
            margin-bottom: 15px;
        }

        .show_model {
            display: block;
        }

    </style>
{% endblock %}

{% block body %}

    <div class="container-fluid">
        <!--左侧侧边栏-->
        <div class="row col-md-2">

            <div class="" id="accordion" role="tablist" aria-multiselectable="true">
                <div class="">
                    <div class="" role="tab" id="headingOne">
                        <h4 class="">
                            <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne"
                               aria-expanded="true"
                               aria-controls="collapseOne">
                                菜单一:还没想好干嘛
                            </a>
                        </h4>
                    </div>
                    <div id="collapseOne" class="collapse in" role="tabpanel" aria-labelledby="headingOne">
                        <div class="">
                            <ul class="nav nav-sidebar">
                                <li><a href="http://v3.bootcss.com/examples/dashboard/">Nav item again</a></li>
                                <li><a href="http://v3.bootcss.com/examples/dashboard/">One more nav</a></li>
                                <li><a href="http://v3.bootcss.com/examples/dashboard/">Another nav item</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="">
                    <div class="" role="tab" id="headingTwo">
                        <h4 class="">
                            <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion"
                               href="#collapseTwo"
                               aria-expanded="false" aria-controls="collapseTwo">
                                菜单二:还没想好干嘛
                            </a>
                        </h4>
                    </div>
                    <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
                        <div class="">
                            <ul class="nav nav-sidebar">
                                <li><a href="http://v3.bootcss.com/examples/dashboard/">Nav item again</a></li>
                                <li><a href="http://v3.bootcss.com/examples/dashboard/">One more nav</a></li>
                                <li><a href="http://v3.bootcss.com/examples/dashboard/">Another nav item</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="">
                    <div class="" role="tab" id="headingThree">
                        <h4 class="">
                            <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion"
                               href="#collapseThree"
                               aria-expanded="false" aria-controls="collapseThree">
                                菜单三:还没想好干嘛
                            </a>
                        </h4>
                    </div>
                    <div id="collapseThree" class="collapse" role="tabpanel" aria-labelledby="headingThree">
                        <div class="">
                            <ul class="nav nav-sidebar">
                                <li><a href="http://v3.bootcss.com/examples/dashboard/">Nav item again</a></li>
                                <li><a href="http://v3.bootcss.com/examples/dashboard/">One more nav</a></li>
                                <li><a href="http://v3.bootcss.com/examples/dashboard/">Another nav item</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <!--左侧侧边栏结束-->

        <!--右侧面板-->
        <div class="container col-md-10" id="total">
            <div class="panel panel-default ">
                <!-- Default panel contents -->
                <div class="panel-heading" id="my_panel_heading">Panel heading
                    <button class="btn btn-info pull-right btn-sm  " data-toggle="modal" data-target="#modal1">添加
                    </button>
                </div>

                <div class="container">
                    <!--搜索表单-->
                    <form class="form-inline">
                        <div class="form-group">
                            <input type="email" class="form-control" id="exampleInputEmail2" placeholder="搜索暂时还不会写">
                        </div>
                        <button type="submit" class="btn btn-default">搜索</button>
                    </form>
                    <!--搜索表单结束-->


                    <!-- Table -->
                    <table class="table">

                        <thead>
                        <tr>
                            <th>编号</th>
                            <th>姓名</th>
                            <th>邮件</th>
                            <th>性别</th>
                            <th>班级</th>
                            <th>属性</th>
                            <th>权限</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for i in datas %}
                            <tr>
                                <th scope="row">1</th>
                                <td>{{ i.name }}</td>
                                <td>{{ i.email }}</td>
                                <td>
                                    {% if i.gender %}
                                        男
                                    {% else %}
                                        女
                                    {% endif %}

                                </td>
                                <td>{{ i.class_name }}</td>
                                <td>
                                    {% if i.attr %}
                                        好人
                                    {% else %}
                                        坏人
                                    {% endif %}</td>
                                <td>{{ i.authority }}</td>
                                <td class="text-center">
                                    <button type="button" class="btn btn-sm btn-success" aria-label="Left Align"
                                            data-toggle="modal" data-target="#modal1">
                                        <span class="glyphicon glyphicon-pencil my_edit_btn" aria-hidden="true"></span>编辑
                                    </button>
                                    <button type="button" class="btn btn-sm btn-danger my_delete_btn"
                                            aria-label="Left Align">
                                        <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>删除
                                    </button>
                                </td>

                            </tr>
                        {% endfor %}

                        </tbody>
                    </table>


                    <!--分页-->
                    <nav aria-label="Page navigation">
                        <ul class="pagination pull-right">
                            <li>
                                <a href="#" aria-label="Previous">
                                    <span aria-hidden="true">&laquo;</span>
                                </a>
                            </li>
                            <li><a href="#">1</a></li>
                            <li><a href="#">2</a></li>
                            <li><a href="#">3</a></li>
                            <li><a href="#">4</a></li>
                            <li><a href="#">5</a></li>
                            <li>
                                <a href="#" aria-label="Next">
                                    <span aria-hidden="true">&raquo;</span>
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div>


            </div>


        </div>
        <!--分页结束-->
        <!--右侧面板结束-->


        <!--模态框-->

        <div id="modal1" class="modal fade" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title">Modal title</h4>
                    </div>


                    {#                表单--管理信息#}
                    <form class="form-horizontal my_add_form" action="{% url 'management:show_students' %}" method="post">
                        <div class="form-group">
                            <label for="inputEmail3" class="col-sm-2 control-label">姓名</label>
                            <div class="col-sm-7">
                                <input type="text" name="username" class="form-control" id="inputEmail3"
                                       placeholder="姓名">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="inputEmail3" class="col-sm-2 control-label">电子邮件</label>
                            <div class="col-sm-7">
                                <input type="email" name="email" class="form-control" id="inputEmail3"
                                       placeholder="电子邮件">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="inputPassword3" class="col-sm-2 control-label">密码</label>
                            <div class="col-sm-7">
                                <input type="password" name="password" class="form-control" id="inputPassword3"
                                       placeholder="密码">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="inputPassword3" class="col-sm-2 control-label">手机号</label>
                            <div class="col-sm-7">
                                <input type="text" name="phone" class="form-control" id="inputPassword3"
                                       placeholder="手机号">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="inputEmail3" class="col-sm-2 control-label">属性</label>
                            <div class="col-sm-7">
                                <input type="text" name="attr" class="form-control" id="inputEmail3" placeholder="属性">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="inputPassword3" class="col-sm-2 control-label">班级名</label>
                            <div class="col-sm-7">
                                <input type="text" name="class_name" class="form-control" id="inputPassword3"
                                       placeholder="班级名">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="inputEmail3" class="col-sm-2 control-label">性别</label>
                            <div class="col-sm-7">
                                <input type="text" name="gender" class="form-control" id="inputEmail3" placeholder="性别">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="inputPassword3" class="col-sm-2 control-label">权限</label>
                            <div class="col-sm-7">
                                <input type="text" name="authority" class="form-control" id="inputPassword3"
                                       placeholder="权限">
                            </div>
                        </div>
                        {#                        <div class="form-group">#}
                        {#                            <label for="inputPassword3" class="col-sm-2 control-label">头像</label>#}
                        {#                            <div class="col-sm-7">#}
                        {#                                <input type="file" name="head_pic" class="form-control" id="inputPassword3" placeholder="头像">#}
                        {#                            </div>#}
                        {#                        </div>#}


                    </form>
                    {#            表单--管理信息结束    #}


                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                        <button type="button" class="btn btn-primary my_add_btn">保存更改</button>
                    </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal -->
        <!--模态框结束-->


    </div>
{% endblock %}

{% block js %}

    <script>
        var $total = $("#total");
        var len = $("table tr").length;
        for (var i = 1; i < len; i++) {
            $('table tr:eq(' + i + ') th').text(i);
        }

{#        //修改序号事件#}
{#        $total.on("click", function () {#}
{#            var len = $("table tr").length;#}
{#            for (var i = 1; i < len; i++) {#}
{#                $('table tr:eq(' + i + ') th').text(i);#}
{#                //只能用字符串拼接的方式将i传到eq里,不能直接传递变量i,原因不明.#}
{#            }#}
{#        });#}

        // 给每一行的删除按钮绑定事件
        $("tbody").on("click", ".my_delete_btn", function () {
            // 删除被点击的删除按钮的那一行
            var $currentTrEle = $(this).parent().parent();
            // 更新序号
            // 找到当前行后面所有的tr,依次更新序号
            $currentTrEle.nextAll().each(function () {
                // 取到原来的序号
                var oldNumber = $(this).children().first().text();
                // 将原来的序号-1,再赋值回去
                $(this).children().first().text(oldNumber - 1);
            });
            $currentTrEle.remove();

        });

        $('.my_add_btn').on('click', function () {
            $('.my_add_form').submit()
        });
    
{#        $('.my_edit_btn').on('click',function () {#}
{#            $('.my_add_form input[name="username"]').val('{{ datas }}')#}
{#        })#}
        $total.on('click','.my_edit_btn',function(){
            $('.my_add_form input[name="username"]').val('{{ i }}')
        })


    </script>
{% endblock %}